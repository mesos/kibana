{
  "id": "{{ kibana_framework_name }}",
  "cpus": {{ kibana_framework_cpu }},
  "mem": {{ kibana_framework_ram }},
  "instances": {{ kibana_framework_instances }},
  "args": [
    "--spring.config.location=/mnt/mesos/sandbox/{{ kibana_framework_properties_name }}"
  ],
  "env": {
    "JAVA_OPTS": "-Xms32m -Xmx{{ kibana_framework_heap }}m"
  },
  "container": {
    "type": "DOCKER",
    "docker": {
      "image": "{{ kibana_framework_image_name }}:{{ kibana_framework_image_tag }}",
      "network": "{{ kibana_framework_network }}"
    }
  },
  "uris": [
    "{{ kibana_framework_properties_path }}"
  ],
  "ports": [{{ framework_ui_port }}],
  "requirePorts": true,
  "labels": {
    "traefik.enable": "false",
    "check_script": "if [[ \"$(curl --silent --show-error --fail --retry 2 --connect-timeout 5 --max-time 5 http://{{ kibana_framework_ip }}:{{ framework_ui_port }}/health | jq -r 'task.status') \" != \"UP\" ]]; then echo The Kibana cluster is not healthy.; exit 1; fi;",
    "check_interval": "30s"
  },
  "healthChecks": [
    {
      "gracePeriodSeconds": 120,
      "intervalSeconds": 10,
      "maxConsecutiveFailures": 6,
      "path": "/",
      "portIndex": 0,
      "protocol": "HTTP",
      "timeoutSeconds": 5
    }
  ]
}
